# Lab 04\. Синхронізація в розподілених програмах

## Завдання

1. Проаналізуйте один із наведених нижче варіантів коду і вкажіть на можливі помилки. Класс Process є частиною [більшого коду](#приклад-коду:) , наведеного в розділі “Приклад коду”  
2. Створіть модульні тести (pytest), які покажуть наявність помилок. Один тест має перевіряти одну помилку.  [Приклад модульних тестів](#модульні-тести:) наведено нижче.  
3. Проаналізуйте важливість знайдених помилок.  
4. Виправте помилки.  
5. За допомогою тестів покажіть, що помилки виправлено.

Результатом роботи є jupyter notebook в  [Google Colab](https://colab.google/) або репозиторій на github, який містить завдання, початковий варіант коду із тестами, виправлений варіант коду із тестами, пояснення виправлень.

Рекомендується використовувати одну з LLM ([https://chatgpt.com/](https://chatgpt.com/) , [https://gemini.google.com/](https://gemini.google.com/) , [https://chat.deepseek.com/](https://chat.deepseek.com/) або іншу) для прискорення роботи. 

## Хід роботи

1. **Ознайомлення з теоретичною частиною:** Повторити принципи алгоритму Лампортівських логічних годинників: правила інкрементування локального часу при локальних подіях, відправленні й отриманні повідомлень; властивості відношення *happens-before*.

2. **Вибір початкового коду:** Ознайомитися з прикладом у розділі «Приклад коду». Визначити клас `Process`, що реалізує модель процесу з локальним логічним годинником і передаванням повідомлень.

3. **Аналіз коду на наявність помилок:** Уважно перевірити, чи дотримано правил алгоритму. Типові можливі проблеми:  
    – відсутність інкремента перед локальною подією;  
    – відправлення повідомлення без оновлення годинника;  
    – неправильне обчислення часу при отриманні (наприклад, замість `max(local, received)+1` використано інший вираз);  
    – відсутність оновлення стану після кількох подій;  
    – неправильне використання спільних змінних у багатопроцесному коді.

4. **Формулювання переліку помилок:**  Структурувати список знайдених недоліків. Для кожної помилки вказати:  
    – де саме вона у коді;  
    – чому це порушує алгоритм Лампорта;  
    – до яких наслідків призведе у реальній системі.

5. **Створення модульних тестів (pytest):** Для кожної знайденої помилки підготувати окремий тест, що її виявляє.  
    – Один тест \= одна помилка.  
    – Тест має показати некоректну поведінку (наприклад, однакові часові мітки для подій із відношенням *happens-before*).

6. **Аналіз важливості помилок:** Оцінити серйозність кожної проблеми:  
    – критичні помилки (порушення властивості *happens-before*);  
    – середньої важливості (некоректні значення, але без повної втрати логіки);  
    – менш критичні (неоптимальність, відсутність додаткових перевірок).

7. **Виправлення коду:** Модифікувати клас `Process`, забезпечивши коректну реалізацію:  
    – інкремент локального годинника перед подіями;  
    – додавання мітки часу до повідомлень;  
    – правильне оновлення часу при отриманні.

8. **Перевірка виправленої версії:** Запустити всі підготовлені тести. Переконатися, що тепер вони проходять успішно, що свідчить про усунення помилок.

9. **Оформлення результатів:** Підготувати Jupyter Notebook у Google Colab або репозиторій на GitHub, що містить:  
    – завдання;  
    – початковий варіант коду з тестами;  
    – опис і класифікацію помилок;  
    – виправлений код;  
    – результати тестів до і після виправлення;  
    – пояснення змін.

10. **Фінальний аналіз і висновки:** Підсумувати: які помилки було знайдено, чому вони небезпечні для алгоритму Лампорта, як вони були виправлені, і як тести підтвердили правильність реалізації.

